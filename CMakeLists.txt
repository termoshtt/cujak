cmake_minimum_required(VERSION 2.8)
PROJECT(cujak)

include_directories(.)
set(CMAKE_BUILD_TYPE Release)

# ctest 
enable_testing()
add_custom_target(short_test COMMAND "ctest" "-R" "TEST_.*_S")
add_custom_target(long_test COMMAND "ctest" "-V" "-R" "TEST_.*_L" "2>&1" ">" "long.log" "&")
add_custom_target(plot_test COMMAND "ctest" "-V" "-R" "TEST_.*_PLOT")
add_custom_target(build_test)
add_dependencies(short_test build_test)

macro(cujak_test name type src)
    set(test_name TEST_${name}_${type})
    add_executable(${test_name} ${src})
    target_link_libraries(${test_name} ${ARGN})
    add_test(${test_name} ${CMAKE_CURRENT_BINARY_DIR}/${test_name})
    add_dependencies(build_test ${test_name})
    unset(test_name)
endmacro(cujak_test)

add_subdirectory(util)
